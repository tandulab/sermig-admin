import{o as S,a as L,s as v,c as D,_ as C,r as p,y as I,b as a,v as V,w as y,h as F,f as i,t as E,e as r,g as n,z as U,u as M,i as R,x}from"../index80545.js";import{e as N,u as P,s as q}from"./helpers80545.js";import{u as z,a as G}from"./upload80545.js";import{F as H}from"./vee-validate.esm80545.js";const J={setup(){S(()=>{g.value=!0,b.value={first:0,rows:o.value.rows,sortField:null,sortOrder:null},b.value.page=0,u()});const m=L(),o=v(),s=v(),e=v(),g=v(!0),b=v(),d=v(0),c=z(),_=D(()=>c.responseBanners);function u(){g.value=!0,setTimeout(()=>{t()},Math.random()*1e3+250)}const t=async function(){await c.fetchAll().then(()=>{g.value=!1}).catch(f=>{g.value=!1,N(m,f)})};return{dt:o,responseBanners:_,loading:g,totalRecords:d,lazyParams:b,currentOrder:s,op:e,loadLazyData:u}}};const K=["src"],Q={key:1,class:"block"},W=["href"],X={key:3},Y=["src"],Z={key:1,class:"block"},$=["href"],ee={key:3,class:"block"},oe=["src"],ne={key:1,class:"block"},te=["href"],le={key:3,class:"block"},ae={class:"flex justify-content-center"};function ie(m,o,s,e,g,b){const d=p("Column"),c=p("Button"),_=p("DataTable"),u=I("tooltip");return a(),V(_,{value:e.responseBanners.banners,lazy:!0,paginator:!1,ref:"dt",loading:e.loading,stripedRows:"",class:"banner"},{empty:y(()=>[F(" Nessun banner email trovato. ")]),default:y(()=>[i(d,{header:"Location",field:"location"},{body:y(({data:t})=>{var f;return[F(E(((f=t.location)==null?void 0:f.name)||"Tutte le location"),1)]}),_:1}),i(d,{header:"Banner header"},{body:y(({data:t})=>[t.image_url?(a(),r("img",{key:0,src:t.image_url},null,8,K)):(a(),r("i",Q,"Nessuna immagine caricata")),t.link?(a(),r("a",{key:2,href:t.link,class:"block",target:"_blank"},"Link",8,W)):(a(),r("i",X,"Nessun link impostato"))]),_:1}),i(d,{header:"Banner footer (up)"},{body:y(({data:t})=>[t.image_foot_up_url?(a(),r("img",{key:0,src:t.image_foot_up_url},null,8,Y)):(a(),r("i",Z,"Nessuna immagine caricata")),t.link_foot_up?(a(),r("a",{key:2,href:t.link_foot_up,class:"block",target:"_blank"},"Link",8,$)):(a(),r("i",ee,"Nessun link impostato"))]),_:1}),i(d,{header:"Banner footer (down)"},{body:y(({data:t})=>[t.image_foot_down_url?(a(),r("img",{key:0,src:t.image_foot_down_url},null,8,oe)):(a(),r("i",ne,"Nessuna immagine caricata")),t.link_foot_down?(a(),r("a",{key:2,href:t.link_foot_down,class:"block",target:"_blank"},"Link",8,te)):(a(),r("i",le,"Nessun link impostato"))]),_:1}),i(d,{header:""},{body:y(({data:t})=>[n("div",ae,[U(i(c,{link:"",icon:"pi pi-pencil",text:"",rounded:"",style:{color:"var(--surface-400)"},onClick:f=>m.$emit("onEditBanner",t)},null,8,["onClick"]),[[u,"Modifica",void 0,{top:!0}]])])]),_:1})]),_:1},8,["value","loading"])}const se=C(J,[["render",ie]]),re={props:["banner"],setup(m,o){S(()=>{m.banner&&(s.value=Object.assign({},m.banner))});const s=v({}),{showLoader:e,hideLoader:g}=P(),b=L(),d=v("it"),c=z(),_=G(),u=M(),t=D(()=>u.languages),f=D(()=>_.responseUploads),B=function(k,h){const w=k.files[0],A={upload:{filename:w.name,type:w.type,owner_id:m.banner.id,owner_type:"Banner",banner_type:h},file:w};_.uploadFile(A)},l=function(){e();let k={it:{standard_ticket_email:s.value.translations.it.standard_ticket_email.text,open_ticket_email:s.value.translations.it.open_ticket_email.text},en:{standard_ticket_email:s.value.translations.en.standard_ticket_email.text,open_ticket_email:s.value.translations.en.open_ticket_email.text}};const h={banner:s.value};h.banner.translations=k,c.updateBanner(h).then(()=>{g(),q(b,{message:"Banner aggiornato correttamente",error:!1}),o.emit("onSubmit")}).catch(w=>{N(b,w)})},O=function(k,h){_.deleteFile(k).then(()=>{T(h,null)})},T=function(k,h){k=="header"?s.value.image_url=h:k=="footer_up"?s.value.image_foot_up_url=h:s.value.image_foot_down_url=h},j=function(){o.emit("onSubmit",s.value)};return R(f,()=>{let k=f.value.url;T(f.value.banner_type,k)}),{form:s,lang_selected:d,uploadedImage:f,languages:t,onSubmit:l,onUploadImage:B,onDeleteFile:O,resetForm:j}},components:{Form:H}};const de={class:"formgrid grid flex-column mt-3"},ce={class:"field col-12 flex flex-column"},me=n("label",{for:"location"},"Location",-1),_e={class:"formgrid grid card mt-3"},ue=n("h3",{class:"col-12 mt-0 p-0"},"Banner header",-1),fe={class:"field col-6 flex flex-column"},pe=n("label",null,"Immagine",-1),ge={key:0,class:"relative wrp-delete"},be=["src"],ve={class:"field col-6 flex flex-column"},ke=n("label",{from:"to_date"},"Link banner header",-1),he={class:"formgrid grid card mt-3"},ye=n("h3",{class:"col-12 mt-0 p-0"},"Banner footer (up)",-1),xe={class:"field col-6 flex flex-column"},Be=n("label",null,"Immagine",-1),we={key:0,class:"relative wrp-delete"},Ve=["src"],Ue={class:"field col-6 flex flex-column"},De=n("label",{from:"to_date"},"Link banner footer (up)",-1),Ee={class:"formgrid grid card mt-3"},Se=n("h3",{class:"col-12 mt-0 p-0"},"Banner footer (down)",-1),Ce={class:"field col-6 flex flex-column"},Te=n("label",null,"Immagine",-1),Fe={key:0,class:"relative wrp-delete"},Le=["src"],Ie={class:"field col-6 flex flex-column"},Ne=n("label",{from:"to_date"},"Link banner footer (down)",-1),ze={class:"col-12 flex justify-content-end m-0 p-0 align-items-center mt-4"},Oe={key:0,class:"formgrid grid card mt-3"},je={class:"col-12 mt-0 p-0"},Ae={class:"field"},Me={key:1,class:"formgrid grid card mt-3"},Re={class:"col-12 mt-0 p-0"},Pe={class:"field"},qe={class:"flex align-items-center justify-content-end mt-6"};function Ge(m,o,s,e,g,b){const d=p("InputText"),c=p("Button"),_=p("FileUpload"),u=p("Dropdown"),t=p("Editor"),f=p("Form"),B=I("tooltip");return e.form?(a(),V(f,{key:0,onSubmit:e.onSubmit,class:"banner"},{default:y(()=>[n("div",de,[n("div",ce,[me,e.form.location?(a(),V(d,{key:0,modelValue:e.form.location.name,"onUpdate:modelValue":o[0]||(o[0]=l=>e.form.location.name=l),disabled:""},null,8,["modelValue"])):x("",!0)])]),n("div",_e,[ue,n("div",fe,[pe,e.form.image_url?(a(),r("div",ge,[e.form.image_url?U((a(),V(c,{key:0,icon:"pi pi-times",rounded:"","aria-label":"Cancel",class:"btn-delete-img",onClick:o[1]||(o[1]=l=>e.onDeleteFile(e.form.image.id,"header"))},null,512)),[[B,"Elimina",void 0,{top:!0}]]):x("",!0),n("img",{src:e.form.image_url},null,8,be)])):x("",!0),i(_,{mode:"basic",name:"demo[]",url:"/api/upload",accept:"image/*",customUpload:"",auto:!0,onUploader:o[2]||(o[2]=l=>e.onUploadImage(l,"header")),class:"mt-3"})]),n("div",ve,[ke,i(d,{modelValue:e.form.link,"onUpdate:modelValue":o[3]||(o[3]=l=>e.form.link=l)},null,8,["modelValue"])])]),n("div",he,[ye,n("div",xe,[Be,e.form.image_foot_up_url?(a(),r("div",we,[U(i(c,{icon:"pi pi-times",rounded:"","aria-label":"Cancel",class:"btn-delete-img",onClick:o[4]||(o[4]=l=>e.onDeleteFile(e.form.image_foot_up.id,"footer_up"))},null,512),[[B,"Elimina",void 0,{top:!0}]]),n("img",{src:e.form.image_foot_up_url},null,8,Ve)])):x("",!0),i(_,{mode:"basic",name:"demo[]",url:"/api/upload",accept:"image/*",customUpload:"",auto:!0,onUploader:o[5]||(o[5]=l=>e.onUploadImage(l,"footer_up")),class:"mt-3"})]),n("div",Ue,[De,i(d,{modelValue:e.form.link_foot_up,"onUpdate:modelValue":o[6]||(o[6]=l=>e.form.link_foot_up=l)},null,8,["modelValue"])])]),n("div",Ee,[Se,n("div",Ce,[Te,e.form.image_foot_down_url?(a(),r("div",Fe,[U(i(c,{icon:"pi pi-times",rounded:"","aria-label":"Cancel",class:"btn-delete-img",onClick:o[7]||(o[7]=l=>e.onDeleteFile(e.form.image_foot_down.id,"footer_down"))},null,512),[[B,"Elimina",void 0,{top:!0}]]),n("img",{src:e.form.image_foot_down_url},null,8,Le)])):x("",!0),i(_,{mode:"basic",name:"demo[]",url:"/api/upload",accept:"image/*",customUpload:"",auto:!0,onUploader:o[8]||(o[8]=l=>e.onUploadImage(l,"footer_down")),class:"mt-3"})]),n("div",Ie,[Ne,i(d,{modelValue:e.form.link_foot_down,"onUpdate:modelValue":o[9]||(o[9]=l=>e.form.link_foot_down=l)},null,8,["modelValue"])])]),n("div",ze,[i(u,{options:e.languages,optionLabel:"name",optionValue:"value",class:"m-2 capitalize dropdown-lng",modelValue:e.lang_selected,"onUpdate:modelValue":o[10]||(o[10]=l=>e.lang_selected=l)},null,8,["options","modelValue"])]),e.form.translations?(a(),r("div",Oe,[n("h3",je," Testo email (biglietti standard) ("+E(e.lang_selected.toUpperCase())+") ",1),n("div",Ae,[i(t,{modelValue:e.form.translations[e.lang_selected].standard_ticket_email.text,"onUpdate:modelValue":o[11]||(o[11]=l=>e.form.translations[e.lang_selected].standard_ticket_email.text=l),editorStyle:"height: 320px"},null,8,["modelValue"])])])):x("",!0),e.form.translations?(a(),r("div",Me,[n("h3",Re," Testo email (biglietti a data aperta)("+E(e.lang_selected.toUpperCase())+") ",1),n("div",Pe,[i(t,{modelValue:e.form.translations[e.lang_selected].open_ticket_email.text,"onUpdate:modelValue":o[12]||(o[12]=l=>e.form.translations[e.lang_selected].open_ticket_email.text=l),editorStyle:"height: 320px"},null,8,["modelValue"])])])):x("",!0),n("div",qe,[i(c,{label:"Annulla",text:"",onClick:o[13]||(o[13]=l=>e.resetForm())}),i(c,{label:"Conferma",type:"submit"})])]),_:1},8,["onSubmit"])):x("",!0)}const He=C(re,[["render",Ge]]),Je={setup(){S(()=>{});const m=v(!1),o=v(),s=v({});return{visibleDialog:m,bannerEmailTable:o,currentBanner:s,onSubmit:function(){m.value=!1,o.value.loadLazyData()},openEditDialog:function(b){m.value=!0,s.value=b}}},components:{BannerEmailTable:se,BannerEmailDialog:He}},Ke=n("h1",null,"Banner email",-1);function Qe(m,o,s,e,g,b){const d=p("BannerEmailTable"),c=p("BannerEmailDialog"),_=p("Dialog");return a(),r("div",null,[Ke,i(d,{ref:"bannerEmailTable",onOnEditBanner:o[0]||(o[0]=u=>e.openEditDialog(u))},null,512),i(_,{visible:e.visibleDialog,"onUpdate:visible":o[2]||(o[2]=u=>e.visibleDialog=u),modal:"",header:"Banner Email",style:{width:"50rem"}},{default:y(()=>[i(c,{onOnSubmit:o[1]||(o[1]=u=>e.onSubmit()),banner:e.currentBanner},null,8,["banner"])]),_:1},8,["visible"])])}const $e=C(Je,[["render",Qe]]);export{$e as default};
